Based on http://regex.alf.nu/

